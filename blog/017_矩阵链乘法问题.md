## 正文

矩阵链乘法问题可描述如下：给定@$n@$个矩阵的链@$\langle A\_1, A\_2, \cdots, A\_n \rangle@$，矩阵@$A\_i@$的规模为@$p_{i-1} \times p\_i(1 \le i \le n)@$，求完全括号化方案，是得计算乘积@$A\_1A\_2 \cdots A\_n@$所需标量乘法次数最少。

在矩阵链乘法问题问题中，此步骤的做法如下所述。为方便起见，我们用符号@$A\_{i, \cdots ,j}@$表示@$A\_iA\_{i+1} \cdots A\_j@$乘积的结果矩阵。可以看出，如果问题是非平凡的，即@$i \lt j@$，那么为了对@$A\_{i, \cdots ,j}@$表示@$A\_iA\_{i+1} \cdots A\_j@$进行括号化，我们就必须在某个@$A\_k@$和@$A\_{k+1}@$之间将矩阵链划分开（@$k@$为@$i \le k \lt j@$间的整数）。也就说，对某个整数@$A\_k@$，我们首先计算矩阵@$A\_{i, \cdots ,k}@$和@$A\_{k+1, \cdots ,j}@$，然后再计算他们的乘积得到最终的结果@$A\_{i, \cdots ,j}@$。此方案的计算代价等于矩阵@$A\_{i, \cdots ,k}@$的计算代价，加上矩阵@$A\_{k+1, \cdots ,j}@$的计算代价，再加上两者相乘的计算代价。

令@$m[i, j]@$表示计算矩阵@$A\_{i, \cdots ,j}@$所需标量乘法次数的最小值，那么，原问题的最优解——计算@$A\_{1, \cdots ,n}@$所需的最低代价就是@$m[1, n]@$。

由于最优分割点必在其中，我们只需要检查所有可能的情况，找到最优者即可。因此@$A\_iA\_{i+1} \cdots A\_j@$最小代价括号化方案的递归求解公式变为：

![](http://mdimg.fabuler.cn/1707/p201.png)

@$m[i, j]@$的值给出了子问题最优解的代价，但它并未提供足够的信息来构造最优解。为此，我们用@$s[i, j]@$保存@$A\_iA\_{i+1} \cdots A\_j@$最优括号化方案的分割点位置@$k@$，即使得@$m[i,j]=m[i,k]+n[k,j]+p\_{i-1}p\_kp\_j@$成立的@$k@$值。

